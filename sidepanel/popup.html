<!--
* Timestamp: 2025-09-16 11:03 AM
* Version: 10.7
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Submission Checker</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="liquid-glass.css">
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="title-area">
        <h2>Submission Checker</h2>
        <button id="version-display" class="version-btn"></button>
      </div>
      <button id="startBtn">
        <img src="../assets/pictures/powericon.png" alt="Start"/>
        <span id="startBtnText">Start</span>
      </button>
    </div>
    
    <div id="loop-counter"></div>
    
    <div class="mode-display-section">
      <button id="activeModeDisplay" class="mode-toggle-btn">Submission Check</button>
    </div>

    <div class="keyword-section">
      Looking for: <span id="keyword">â€¦</span>
    </div>
    
    <div class="tabs">
      <button class="tab-button active" data-tab="found">
        Found
        <span class="badge"><span class="count">0</span></span>
      </button>
      <button class="tab-button" data-tab="master">
        Master List
        <span class="badge"><span class="count">0</span></span>
      </button>
      <button class="tab-button" data-tab="settings">Settings</button>
    </div>
    
    <div id="found" class="tab-content active">
      <div class="section">
        <input type="text" id="searchFoundListInput" placeholder="Search Found List...">
        <ul id="foundList" class="found-list"></ul>
      </div>
      <button id="clearBtn">Clear All</button>
    </div>
    <div id="master" class="tab-content">
      <button id="updateMasterBtn">Update Master List</button>
      <input type="text" id="newItemInput" placeholder="Search Name or Days Out..." />
      <div class="filter-section">
          <button id="nameSortBtn" class="filter-button">Sort by Name</button>
          <button id="daysOutSortBtn" class="filter-button">Sort by Days Out</button>
      </div>
      <div class="section">
        <div class="list-header">
          <span id="lastUpdatedTime" class="timestamp"></span>
        </div>
        <ul id="masterList" class="found-list"></ul>
      </div>
    </div>
    
    <div id="settings" class="tab-content">
        <div class="settings-scroll-container">
            <div class="section">
                <h3>Settings</h3>
                <div class="setting-item">
                    <label for="checkerModeToggle">Checker Mode</label>
                    <label class="switch">
                        <input type="checkbox" id="checkerModeToggle">
                        <span class="slider round"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <label for="concurrentTabsInput">Concurrent Tabs (1-10)</label>
                    <input type="number" id="concurrentTabsInput" min="1" max="10">
                </div>
                <div class="setting-item">
                    <label for="looperDaysOutFilterInput">Loop Filter: Days Out</label>
                    <input type="text" id="looperDaysOutFilterInput" placeholder="e.g., >=5 or all">
                </div>
                <div class="setting-item">
                    <label for="customKeywordInput">Custom Keyword</label>
                    <input type="text" id="customKeywordInput" placeholder="Default: Today's Date">
                </div>
                <div class="setting-item">
                    <label for="colorPicker">Highlight Color</label>
                    <input type="color" id="colorPicker" value="#ffff00">
                </div>
                <div class="setting-item">
                    <label for="debugToggle">Debug Mode</label>
                    <label class="switch">
                        <input type="checkbox" id="debugToggle">
                        <span class="slider round"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <label>Debug Console</label>
                    <button id="toggleConsoleBtn" class="filter-button">Show Console</button>
                </div>

                <h4 style="margin-top: 20px; border-top: 1px solid rgba(0,0,0,0.1); padding-top: 15px;">Connections</h4>
                <div id="connections-section" class="section" style="border-top: none; padding-top: 5px;">
                  <ul id="connectionsList" class="connections-list"></ul>
                  <button id="createConnectionBtn">Create Connection</button>
                </div>
            </div>
        </div>
        <button id="sharepointBtn" class="footer-link">SharePoint</button>
    </div>

    <div id="about" class="tab-content">
        <div class="settings-scroll-container">
            <div class="section">
                <h3>About This Extension</h3>
                <p>This extension is designed to streamline the process of checking for student submissions in Canvas.</p>
                <button id="showJsonExampleBtn" class="filter-button" style="margin-top: 10px; width: 180px;">Show JSON Example</button>
            </div>
        </div>
    </div>
  </div>

  <div id="list-context-menu">
      <button id="copyNameBtn">Copy Name</button>
      <button id="copyUrlBtn">Copy Gradebook Link</button>
      <hr/>
      <button id="debugSendBtn">Send Debug to Connections</button>
  </div>

  <!-- JSON Example Modal -->
  <div id="json-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <span class="modal-close" data-modal-id="json-modal">&times;</span>
      <h3>JSON Example</h3>
      <p>Copy this structure and update your master list from a spreadsheet's "Export to JSON" feature.</p>
      <pre><code>[
  {
    "StudentName": "Doe, Jane",
    "GradeBook": "https://canvas.example.com/courses/123/grades/456",
    "DaysOut": 5,
    "LDA": "2023-10-27T10:00:00Z",
    "Grade": "95%"
  },
  {
    "StudentName": "Smith, John",
    "GradeBook": "https://canvas.example.com/courses/123/grades/457",
    "DaysOut": 12,
    "LDA": "2023-10-16T11:30:00Z",
    "Grade": "88%"
  }
]</code></pre>
    </div>
  </div>

  <!-- Connections Modal -->
  <div id="connections-modal" class="modal-overlay" style="display: none;">
      <div class="modal-content">
          <span class="modal-close" data-modal-id="connections-modal">&times;</span>
          <div id="connection-chooser">
              <h3>Create New Connection</h3>
              <p>Choose a service to connect to, or paste a valid configuration on your clipboard to auto-detect.</p>
              <div class="connection-options">
                  <button class="connection-choice-btn" data-type="power-automate">
                      <img src="../assets/pictures/power-automate-icon.png" alt="Power Automate">
                      <div class="connection-choice-text">
                        <span class="connection-choice-title">Power Automate</span>
                        <span class="connection-choice-desc">Trigger a workflow.</span>
                      </div>
                  </button>
                  <button class="connection-choice-btn" data-type="pusher">
                      <img src="../assets/pictures/pusher-icon.png" alt="Pusher">
                      <div class="connection-choice-text">
                        <span class="connection-choice-title">Pusher</span>
                        <span class="connection-choice-desc">Send real-time events.</span>
                      </div>
                  </button>
              </div>
              <button id="payloadExampleBtn" class="footer-link">Show Payload Example</button>
          </div>
          <div id="connection-form-container" style="display: none;">
              <form id="power-automate-form" class="connection-form" style="display: none;">
                  <div class="connection-form-header">
                    <img src="../assets/pictures/power-automate-icon.png" alt="Power Automate">
                    <a href="https://www.microsoft.com/en-us/power-platform/products/power-automate" target="_blank" rel="noopener noreferrer">
                      <h3>Power Automate</h3>
                    </a>
                  </div>
                  <div class="setting-item">
                      <label for="pa-name">Connection Name <i class="info-icon" data-tooltip="A friendly name for this connection (e.g., 'Email Notifier').">i</i></label>
                      <input type="text" id="pa-name" required>
                  </div>
                  <div class="setting-item">
                      <label for="pa-url">HTTP Request URL <i class="info-icon" data-tooltip="The URL provided by the 'When an HTTP request is received' trigger in your Power Automate flow.">i</i></label>
                      <input type="url" id="pa-url" required>
                  </div>
                  <div class="form-actions">
                      <span id="pa-test-status" class="test-status"></span>
                      <button type="button" class="form-test-btn">Test</button>
                      <button type="button" class="form-cancel-btn">Cancel</button>
                      <button type="submit">Save</button>
                  </div>
              </form>
              <form id="pusher-form" class="connection-form" style="display: none;">
                  <div class="connection-form-header">
                    <img src="../assets/pictures/pusher-icon.png" alt="Pusher">
                     <a href="https://pusher.com/" target="_blank" rel="noopener noreferrer">
                      <h3>Pusher</h3>
                    </a>
                  </div>
                  <div class="setting-item">
                      <label for="pusher-name">Connection Name <i class="info-icon" data-tooltip="A friendly name for this connection (e.g., 'Live Dashboard').">i</i></label>
                      <input type="text" id="pusher-name" required>
                  </div>
                  <div class="setting-item">
                      <label for="pusher-key">App Key <i class="info-icon" data-tooltip="Found in your Pusher app's 'Keys' page.">i</i></label>
                      <input type="text" id="pusher-key" required>
                  </div>
                  <div class="setting-item">
                      <label for="pusher-cluster">Cluster <i class="info-icon" data-tooltip="The cluster your Pusher app was created in (e.g., 'us2', 'eu').">i</i></label>
                      <input type="text" id="pusher-cluster" required>
                  </div>
                  <div class="setting-item">
                      <label for="pusher-secret">App Secret <i class="info-icon" data-tooltip="The secret key for your Pusher app. This is sensitive and will be stored securely.">i</i></label>
                      <input type="password" id="pusher-secret" required>
                  </div>
                  <div class="setting-item">
                      <label for="pusher-channel">Channel Name <i class="info-icon" data-tooltip="The name of the private channel to publish events to. Must start with 'private-'.">i</i></label>
                       <div class="prefixed-input-wrapper">
                          <span class="input-prefix">private-</span>
                          <input type="text" id="pusher-channel" placeholder="my-channel" required>
                      </div>
                  </div>
                  <div class="setting-item">
                      <label for="pusher-event">Event Name <i class="info-icon" data-tooltip="The name of the client event to trigger. Must start with 'client-'.">i</i></label>
                      <div class="prefixed-input-wrapper">
                          <span class="input-prefix">client-</span>
                          <input type="text" id="pusher-event" placeholder="new-submission" required>
                      </div>
                  </div>
                  <div class="form-actions">
                      <span id="pusher-test-status" class="test-status"></span>
                      <button type="button" class="form-test-btn">Test</button>
                      <button type="button" class="form-cancel-btn">Cancel</button>
                      <button type="submit">Save</button>
                  </div>
              </form>
          </div>
      </div>
  </div>

  <!-- Payload Example Modal -->
  <div id="payload-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <span class="modal-close" data-modal-id="payload-modal">&times;</span>
      <h3>Payload Example</h3>
      <p>This is the JSON data that will be sent to your connection.</p>
      <pre><code>{
  "name": "Doe, Jane",
  "time": "Sep 1 at 10:30 AM",
  "url": "https://canvas.example.com/courses/123/grades/456",
  "timestamp": "2023-09-01T14:30:00.000Z"
}</code></pre>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="delete-confirm-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <span class="modal-close" data-modal-id="delete-confirm-modal">&times;</span>
      <h3>Confirm Deletion</h3>
      <p>Are you sure you want to delete this connection? This action cannot be undone.</p>
      <div class="modal-actions">
        <button id="cancelDeleteBtn" class="btn-secondary">Cancel</button>
        <button id="confirmDeleteBtn" class="btn-danger">Delete</button>
      </div>
    </div>
  </div>

  <!-- Export Modal -->
  <div id="export-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <span class="modal-close" data-modal-id="export-modal">&times;</span>
      <h3>Export Connection</h3>
      <div class="setting-item" id="export-secret-toggle-container">
          <label for="exportIncludeSecretToggle">Include Secret</label>
          <label class="switch">
              <input type="checkbox" id="exportIncludeSecretToggle">
              <span class="slider round"></span>
          </label>
      </div>
      <pre><code id="exportJsonContent"></code></pre>
      <div class="modal-actions">
        <button id="copyExportBtn" class="btn-primary">Copy to Clipboard</button>
      </div>
    </div>
  </div>
  
  <!-- Missing Assignments Report Modal -->
  <div id="report-modal" class="modal-overlay" style="display: none;">
      <div class="modal-content">
          <span class="modal-close" data-modal-id="report-modal">&times;</span>
          <h3>Missing Assignments Report</h3>
          <p id="reportSummaryText">Scan complete.</p>
          
          <div id="report-view-container">
              <div id="report-formatted-view"></div>
              <div id="report-json-view" style="display: none;">
                  <div class="json-container-wrapper">
                      <pre><code id="reportJsonContent"></code></pre>
                      <button id="copyReportJsonBtn" class="copy-json-btn" title="Copy JSON to clipboard">
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="copy-icon" viewBox="0 0 16 16">
                              <path fill-rule="evenodd" d="M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V2zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H6zM2 5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-1h1v1a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1v1H2z"/>
                          </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="checkmark-icon" style="display:none;" viewBox="0 0 16 16">
                              <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                          </svg>
                      </button>
                  </div>
              </div>
          </div>

          <div class="modal-actions">
              <button id="toggleReportViewBtn" class="btn-secondary">View JSON</button>
              <button id="downloadReportCsvBtn" class="btn-primary">Download CSV</button>
          </div>
      </div>
  </div>


  <div id="debug-console" class="modal-overlay">
    <div id="debug-console-content">
      <div id="debug-console-header">
        <span>Debug Console</span>
        <button class="modal-close" id="closeConsoleBtn">&times;</button>
      </div>
      <div id="debug-console-log-area"></div>
      <div class="modal-actions">
          <button id="clearConsoleBtn" class="btn-secondary">Clear</button>
          <!-- MODIFIED: Add resize handle -->
          <div class="resize-handle">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 14L10 10" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round"/><path d="M9 14L5 10" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round"/></svg>
          </div>
      </div>
    </div>
  </div>
    
  <script src="../lib/pusher.min.js"></script>
  <script src="popup.js" type="module"></script>
  <script src="popupSearch.js" type="module"></script>
</body>
</html>

